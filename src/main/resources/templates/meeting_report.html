<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="th" dir="ltr">

<head>
    <meta charset="UTF-8" />
    <style>
        @page {
            size: A4;
            margin-top: 2.5cm;
            margin-bottom: 2cm;
            margin-left: 2.8cm;
            margin-right: 2cm;

            @top-right {
                content: "หน้า " counter(page);
                font-family: 'Sarabun', sans-serif;
                font-size: 16pt;
                color: #000;
                vertical-align: bottom;
                padding-bottom: 0;
            }
        }

        @font-face {
            font-family: 'Sarabun';
            src: url('fonts/THSarabunNew.ttf');
            -fs-pdf-font-embed: embed;
            -fs-pdf-font-encoding: Identity-H;
        }

        @font-face {
            font-family: 'Sarabun';
            src: url('fonts/THSarabunNew-Bold.ttf');
            font-weight: bold;
            -fs-pdf-font-embed: embed;
            -fs-pdf-font-encoding: Identity-H;
        }

        body {
            font-family: 'Sarabun', sans-serif;
            font-size: 16pt;
            line-height: 1.0;
            color: #000;
            text-align: justify;
            text-justify: inter-word;
        }

        .garuda {
            display: block;
            margin: 0 auto;
            width: 1.5cm;
            height: auto;
        }

        .header-title {
            text-align: center;
            font-weight: bold;
            font-size: 18pt;
            line-height: 1.0;
            margin-bottom: 5px;
            margin-top: 10px;
        }

        .header-info {
            text-align: center;
            font-weight: normal;
            font-size: 16pt;
            line-height: 1.0;
            margin-bottom: 15px;
        }

        .section-title {
            font-weight: bold;
            font-size: 16pt;
            margin-top: 10px;
            margin-bottom: 5px;
            text-indent: 2.5cm;
        }

        .content {
            line-height: 1.0;
        }

        .content>p,
        .content>div {
            text-indent: 2.5cm;
            margin: 0;
        }

        .content>div>div {
            text-indent: 2.5cm;
        }

        .list-container {
            margin-top: 2px;
            margin-bottom: 5px;
            line-height: 1.0;
        }

        .list-item,
        .attendee-item {
            display: block;
            padding-left: 3.2cm;
            text-indent: -0.7cm;
            line-height: 1.0;
            margin-bottom: 2px;
        }

        .item-number {
            display: inline-block;
            width: 0.6cm;
            text-align: right;
            margin-right: 0.1cm;
        }

        .item-text {
            display: inline;
        }

        u,
        .underline {
            text-decoration: underline;
            text-decoration-color: #000;
            text-decoration-thickness: 1px;
            text-decoration-skip-ink: none;
            display: inline;
        }

        .sub-header {
            font-weight: bold;
            font-size: 16pt;
            margin-top: 8px;
            margin-bottom: 3px;
            margin-left: 2.5cm;
            line-height: 1.0;
        }

        .signature-block {
            width: 100%;
            margin-top: 30px;
            page-break-inside: avoid;
            line-height: 1.0;
        }

        .signature-block td {
            vertical-align: top;
            padding-top: 5px;
            font-size: 16pt;
        }

        .empty-data {
            padding-left: 2.5cm;
        }

        .resolution-section {
            margin-top: 30px;
            border-top: 1px solid #000;
            padding-top: 20px;
        }

        .resolution-title {
            text-align: center;
        }
    </style>
</head>

<body>

    <div class="header-title" th:text="${meetingTitle}">รายงานการประชุม...</div>

    <div class="header-info">
        <div
            th:text="'ครั้งที่ ' + (${meetingNo} ?: '-') + ' เมื่อวันที่ ' + (${formattedDate} ?: '-') + ' ณ ' + (${location} ?: '-') + ' เวลา '+ (${meetingTime} ?: '-') + ' น.'">
        </div>
    </div>

    <div class="section-title">ผู้มาประชุม</div>
    <div class="list-container">
        <div th:if="${#lists.isEmpty(attendees)}" class="empty-data">- ไม่มีข้อมูล -</div>
        <div th:each="attendee, iter : ${attendees}" class="attendee-item">
            <span class="item-number" th:text="${iter.count} + '.'"></span>
            <span class="item-text" th:text="${attendee.prename} + ${attendee.firstname} + ' ' + ${attendee.lastname} +
                           (${attendee.department} != null ? ' (' + ${attendee.department} + ')' : '')">
            </span>
        </div>
    </div>

    <div class="section-title">ระเบียบวาระที่ ๑</div>
    <div class="content" th:utext="${agendaOne}"></div>

    <div class="section-title">ระเบียบวาระที่ ๒</div>
    <div class="content" th:utext="${agendaTwo}"></div>

    <div class="section-title">ระเบียบวาระที่ ๓</div>
    <div class="content" th:utext="${agendaThree}"></div>

    <div class="section-title">ระเบียบวาระที่ ๔</div>

    <div class="sub-header">๔.๑ รายชื่อผู้เกี่ยวข้อง</div>
    <div class="list-container">
        <div th:if="${#lists.isEmpty(agendaFourItems)}" class="empty-data">- ไม่มีรายชื่อ -</div>
        <div th:each="item : ${agendaFourItems}" class="list-item">
            <span class="item-number" th:text="${item.order} + '.'"></span>
            <span class="item-text" th:text="${item.name} + (${item.region} != '-' ? ' (' + ${item.region} + ')' : '')">
            </span>
        </div>
    </div>

    <div class="sub-header">๔.๒ รายการทรัพย์สิน</div>
    <div class="list-container">
        <div th:if="${#lists.isEmpty(agendaFourAssets)}" class="empty-data">- ไม่มีรายการทรัพย์สิน -</div>
        <div th:each="asset : ${agendaFourAssets}" class="list-item">
            <span class="item-number" th:text="${asset.no} + '.'"></span>
            <span class="item-text">
                <span th:text="${asset.asset}"></span>
                <span th:if="${asset.fileNo != null and asset.fileNo != '' and asset.fileNo != '-'}"
                    th:text="' (' + ${asset.fileNo} + ')'"></span>
                <span th:text="' มูลค่า ' + ${asset.amount} + ' บาท'"></span>
                <span th:if="${asset.status != ''}" th:text="' [' + ${asset.status} + ']'"></span>
            </span>
        </div>
    </div>

    <div class="section-title">ระเบียบวาระที่ ๕</div>

    <div class="sub-header">๕.๑ รายชื่อผู้เกี่ยวข้อง</div>
    <div class="list-container">
        <div th:if="${#lists.isEmpty(agendaFiveItems)}" class="empty-data">- ไม่มีรายชื่อ -</div>
        <div th:each="item : ${agendaFiveItems}" class="list-item">
            <span class="item-number" th:text="${item.order} + '.'"></span>
            <span class="item-text" th:text="${item.name}"></span>
        </div>
    </div>

    <div class="sub-header">๕.๒ รายการทรัพย์สิน</div>
    <div class="list-container">
        <div th:if="${#lists.isEmpty(agendaFiveAssets)}" class="empty-data">- ไม่มีรายการทรัพย์สิน -</div>
        <div th:each="asset : ${agendaFiveAssets}" class="list-item">
            <span class="item-number" th:text="${asset.no} + '.'"></span>
            <span class="item-text">
                <span th:text="${asset.asset}"></span>
                <span th:if="${asset.fileNo != null and asset.fileNo != '' and asset.fileNo != '-'}"
                    th:text="' (' + ${asset.fileNo} + ')'"></span>
                <span th:text="' มูลค่า ' + ${asset.amount} + ' บาท'"></span>
                <span th:if="${asset.status != ''}" th:text="' [' + ${asset.status} + ']'"></span>
            </span>
        </div>
    </div>

    <div th:if="${hasResolution}" class="resolution-section">
        <div class="section-title resolution-title">สรุปมติที่ประชุม</div>

        <div th:if="${resDetail != null}">
            <div class="sub-header">มติทั่วไป</div>
            <div class="content" th:utext="${resDetail}"></div>
        </div>

        <div th:if="${resFour != null}">
            <div class="sub-header">มติวาระที่ ๔</div>
            <div class="content" th:utext="${resFour}"></div>
        </div>

        <div th:if="${resFive != null}">
            <div class="sub-header">มติวาระที่ ๕</div>
            <div class="content" th:utext="${resFive}"></div>
        </div>
    </div>

    <table class="signature-block">
        <tr>
            <td style="width: 50%;"></td>
            <td style="width: 50%; text-align: center;">
                <div>ลงชื่อ................................................ผู้จดรายงานการประชุม</div>
                <div style="margin-top: 5px;">(................................................)</div>
                <div style="margin-top: 5px;">ตำแหน่ง................................................</div>
            </td>
        </tr>
    </table>

</body>

</html>